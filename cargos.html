<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cargos • Gestão de RH</title>

  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="cargos.css" />

  <!-- Carrega o menu/header automaticamente -->
  <script src="js/include-menu.js" defer></script>
</head>

<body>
  <!-- Menu/Header (vem do components/menu.html) -->
  <div id="app-menu"></div>

  <main class="cargos-page">
    <!-- ====== VIEW: LISTA ====== -->
    <section id="view-list" class="cargos-view is-active" aria-label="Lista de Cargos">
      <header class="page-head">
        <div>
          <h2 class="page-title">Cargos</h2>
          <p class="page-subtitle">Gerencie os cargos da empresa e seus vínculos com estrutura e competências.</p>
        </div>

        <!-- ✅ agora abre a tela de cadastro -->
        <button id="btnNewCargo" class="btn btn--success" type="button">
          <span class="btn__icon" aria-hidden="true">+</span>
          Incluir
        </button>
      </header>

      <div class="card">
        <div class="toolbar">
          <div class="search">
            <span class="search__icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M10 2a8 8 0 1 0 4.9 14.3l4.4 4.4 1.4-1.4-4.4-4.4A8 8 0 0 0 10 2zm0 2a6 6 0 1 1 0 12 6 6 0 0 1 0-12z"/></svg>
            </span>
            <input id="searchInput" class="search__input" type="text" placeholder="Pesquisar..." />
          </div>

          <span class="hint">Clique no <strong>Nome do Cargo</strong> para abrir o cadastro.</span>
        </div>

        <div class="table-wrap">
          <table class="table" aria-label="Tabela de cargos">
            <thead>
              <tr>
                <th>Nome do Cargo</th>
                <th>Área</th>
                <th>Departamento</th>
                <th class="col-date">Data da última alteração</th>
                <th class="col-status">Status</th>
              </tr>
            </thead>

            <tbody id="cargosTbody">
              <tr>
                <td><button class="row-link" type="button" data-id="diretor">Diretor(a)</button></td>
                <td>Diretoria</td>
                <td>Diretoria</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="auxiliar-administrativo">Auxiliar Administrativo</button></td>
                <td>Administrativo</td>
                <td>Administrativo</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="assistente-administrativo">Assistente Administrativo</button></td>
                <td>Administrativo</td>
                <td>Administrativo</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="analista-adm-jr">Analista Administrativo Júnior</button></td>
                <td>Administrativo</td>
                <td>Administrativo</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="supervisor-administrativo">Supervisor Administrativo</button></td>
                <td>Administrativo</td>
                <td>Administrativo</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="auxiliar-financeiro">Auxiliar Financeiro</button></td>
                <td>Administrativo</td>
                <td>Financeiro</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="assistente-financeiro">Assistente Financeiro</button></td>
                <td>Administrativo</td>
                <td>Financeiro</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="analista-fin-jr">Analista Financeiro Júnior</button></td>
                <td>Administrativo</td>
                <td>Financeiro</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="supervisor-financeiro">Supervisor Financeiro</button></td>
                <td>Administrativo</td>
                <td>Financeiro</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="auxiliar-contabil">Auxiliar Contábil</button></td>
                <td>Operacional</td>
                <td>Contábil</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="assistente-contabil">Assistente Contábil</button></td>
                <td>Operacional</td>
                <td>Contábil</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="analista-cont-jr">Analista Contábil Júnior</button></td>
                <td>Operacional</td>
                <td>Contábil</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="supervisor-contabil">Supervisor Contábil</button></td>
                <td>Operacional</td>
                <td>Contábil</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="coordenador-contabil">Coordenador Contábil</button></td>
                <td>Operacional</td>
                <td>Contábil</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="auxiliar-fiscal">Auxiliar Fiscal</button></td>
                <td>Operacional</td>
                <td>Fiscal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="assistente-fiscal">Assistente Fiscal</button></td>
                <td>Operacional</td>
                <td>Fiscal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="analista-fisc-jr">Analista Fiscal Júnior</button></td>
                <td>Operacional</td>
                <td>Fiscal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="supervisor-fiscal">Supervisor Fiscal</button></td>
                <td>Operacional</td>
                <td>Fiscal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="coordenador-fiscal">Coordenador Fiscal</button></td>
                <td>Operacional</td>
                <td>Fiscal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="auxiliar-dp">Auxiliar de DP</button></td>
                <td>Operacional</td>
                <td>Departamento Pessoal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="assistente-dp">Assistente de DP</button></td>
                <td>Operacional</td>
                <td>Departamento Pessoal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="analista-dp-jr">Analista de DP Júnior</button></td>
                <td>Operacional</td>
                <td>Departamento Pessoal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="supervisor-dp">Supervisor de DP</button></td>
                <td>Operacional</td>
                <td>Departamento Pessoal</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="consultor-comercial-i">Consultor Comercial I</button></td>
                <td>Comercial</td>
                <td>Vendas</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="consultor-comercial-ii">Consultor Comercial II</button></td>
                <td>Comercial</td>
                <td>Vendas</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="consultor-comercial-iii">Consultor Comercial III</button></td>
                <td>Comercial</td>
                <td>Vendas</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

              <tr>
                <td><button class="row-link" type="button" data-id="supervisor-comercial">Supervisor Comercial</button></td>
                <td>Comercial</td>
                <td>Vendas</td>
                <td class="col-date">10/01/2026</td>
                <td class="col-status"><span class="badge badge--active">Ativo</span></td>
              </tr>

            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ====== VIEW: CADASTRO (DETALHE) ====== -->
    <section id="view-detail" class="cargos-view" aria-label="Cadastro do Cargo">
      <header class="detail-head">
        <button id="btnBack" class="back-link" type="button">← Voltar</button>
        <h2 id="cargoTitle" class="detail-title">Cargo</h2>
      </header>

      <nav class="tabs" aria-label="Abas do Cadastro de Cargo">
        <button class="tabs__tab is-active" type="button" data-tab="dados">Dados Gerais</button>
        <button class="tabs__tab" type="button" data-tab="responsabilidades">Responsabilidades</button>
        <button class="tabs__tab" type="button" data-tab="tecnicas">Competências Técnicas</button>
        <button class="tabs__tab" type="button" data-tab="comportamentais">Competências Comportamentais</button>
        <button class="tabs__tab" type="button" data-tab="indicadores">Indicadores de Performance</button>
      </nav>

      <section class="tabpanels">
        <!-- DADOS -->
        <div class="tabpanel is-active" id="tab-dados">
          <div class="card">
            <div class="form-grid">
              <div class="field">
                <label for="f_nome">Nome do cargo</label>
                <input id="f_nome" type="text" value="" />
              </div>

              <div class="field">
                <label for="f_cbo">CBO</label>
                <input id="f_cbo" type="text" value="" />
              </div>

              <div class="field">
                <label for="f_ultima">Data da última alteração</label>
                <div id="f_ultima" class="readonly">—</div>
              </div>

              <div class="field">
                <label>É cargo de liderança:</label>
                <div class="segmented" role="group" aria-label="Cargo de liderança">
                  <button id="leadSim" class="segmented__btn" type="button">Sim</button>
                  <button id="leadNao" class="segmented__btn is-active" type="button">Não</button>
                </div>
              </div>

              <div class="field">
                <label for="f_area">Área vinculada</label>
                <select id="f_area">
                  <option>Diretoria</option>
                  <option>Administrativo</option>
                  <option>Operacional</option>
                  <option>Comercial</option>
                </select>
              </div>

              <div class="field">
                <label for="f_depto">Departamento vinculado</label>
                <select id="f_depto">
                  <option>Diretoria</option>
                  <option>Administrativo</option>
                  <option>Financeiro</option>
                  <option>Contábil</option>
                  <option>Fiscal</option>
                  <option>Departamento Pessoal</option>
                  <option>Vendas</option>
                </select>
              </div>

              <div class="field">
                <label for="f_ccusto">Centro de custo vinculado</label>
                <select id="f_ccusto">
                  <option>N/A</option>
                  <option>1.1 Financeiro</option>
                  <option>1.2 RH</option>
                  <option>2.1 Produção</option>
                  <option>2.2 Supervisão</option>
                </select>
              </div>

              <div class="field">
                <label for="f_lideranca">Cargo de liderança</label>
                <select id="f_lideranca">
                  <option>Selecione...</option>
                  <option>Supervisor Administrativo</option>
                  <option>Supervisor Financeiro</option>
                  <option>Supervisor Contábil</option>
                  <option>Supervisor Fiscal</option>
                  <option>Supervisor de DP</option>
                  <option>Supervisor Comercial</option>
                  <option>Diretor(a)</option>
                </select>
              </div>

              <div class="field">
                <label>Status</label>
                <div class="radio-row">
                  <label class="radio">
                    <input type="radio" name="status" value="Ativo" checked />
                    <span>Ativo</span>
                  </label>
                  <label class="radio">
                    <input type="radio" name="status" value="Inativo" />
                    <span>Inativo</span>
                  </label>
                </div>
              </div>

              <div class="field">
                <label>Número de pessoas vinculadas</label>
                <div id="f_vinculados" class="readonly">—</div>
              </div>
            </div>

            <!-- ✅ no protótipo: quando é novo cargo, mostra Salvar -->
            <div class="card-actions" id="cargoActions">
              <button id="btnEditarCargo" class="btn btn--ghost" type="button" onclick="alert('Editar ainda não implementado')">Editar</button>
              <button id="btnSalvarCargo" class="btn btn--success" type="button" hidden>
                <span class="btn__icon" aria-hidden="true">✓</span>
                Salvar
              </button>
            </div>
          </div>
        </div>

        <!-- RESPONSABILIDADES -->
        <div class="tabpanel" id="tab-responsabilidades">
          <div class="card">
            <h3 class="section-title">Missão do Cargo</h3>
            <p id="missaoText" class="text">—</p>

            <h3 class="section-title">Principais Responsabilidades</h3>
            <ul id="respList" class="checklist"></ul>

            <div class="card-actions">
              <button class="btn btn--ghost" type="button" onclick="alert('Editar ainda não implementado')">Editar</button>
            </div>
          </div>
        </div>

        <!-- TÉCNICAS -->
        <div class="tabpanel" id="tab-tecnicas">
          <div class="card">
            <div class="panel-head">
              <h3 class="section-title">Competências Técnicas</h3>
              <button id="btnAddTec" class="btn btn--success" type="button">
                <span class="btn__icon" aria-hidden="true">+</span>
                Incluir
              </button>
            </div>

            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th>Competência</th>
                    <th>Descrição</th>
                    <th class="col-small">Nível de Exigência</th>
                    <th class="col-actions">Ações</th>
                  </tr>
                </thead>
                <tbody id="tecTbody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- COMPORTAMENTAIS -->
        <div class="tabpanel" id="tab-comportamentais">
          <div class="card">
            <div class="panel-head">
              <h3 class="section-title">Competências Comportamentais</h3>
              <button id="btnAddComp" class="btn btn--success" type="button">
                <span class="btn__icon" aria-hidden="true">+</span>
                Incluir
              </button>
            </div>

            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th>Competência</th>
                    <th>Descrição</th>
                    <th class="col-small">Grupo</th>
                    <th class="col-mini">Grau</th>
                    <th>Indicadores</th>
                    <th class="col-actions">Ações</th>
                  </tr>
                </thead>
                <tbody id="compTbody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- INDICADORES -->
        <div class="tabpanel" id="tab-indicadores">
          <div class="card">
            <div class="panel-head">
              <h3 class="section-title">Indicadores de Performance</h3>

              <!-- ✅ incluir + mantém editar -->
              <div class="panel-actions">
                <button id="btnAddPerf" class="btn btn--success" type="button">
                  <span class="btn__icon" aria-hidden="true">+</span>
                  Incluir
                </button>
                <button class="btn btn--ghost" type="button" onclick="alert('Editar ainda não implementado')">Editar</button>
              </div>
            </div>

            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th>Indicador</th>
                    <th>Descrição</th>
                    <th class="col-actions">Ações</th>
                  </tr>
                </thead>
                <tbody id="perfTbody"></tbody>
              </table>
            </div>
          </div>
        </div>

      </section>
    </section>
  </main>

  <!-- ✅ MODAL CRUD (Incluir/Editar) -->
  <div class="modal" id="crudModal" hidden>
    <div class="modal__backdrop" data-close="1"></div>

    <div class="modal__dialog" role="dialog" aria-modal="true" aria-label="Cadastro">
      <div class="modal__head">
        <h3 class="modal__title" id="crudTitle">Cadastro</h3>
        <button class="modal__close" type="button" data-close="1">Fechar</button>
      </div>

      <form id="crudForm" class="modal__form">
        <input type="hidden" id="crudKind" value="" />
        <input type="hidden" id="crudMode" value="create" />
        <input type="hidden" id="crudIndex" value="-1" />

        <!-- Técnicas -->
        <div class="crud-block" data-kind="tec">
          <div class="form-grid">
            <div class="field">
              <label for="t_comp">Competência</label>
              <input id="t_comp" type="text" placeholder="Ex: Excel" />
            </div>

            <div class="field">
              <label for="t_nivel">Nível de Exigência</label>
              <input id="t_nivel" type="text" placeholder="Ex: Básico / Intermediário / Avançado" />
            </div>

            <div class="field field--full">
              <label for="t_desc">Descrição</label>
              <textarea id="t_desc" rows="3" placeholder="Descreva a competência..."></textarea>
            </div>
          </div>
        </div>

        <!-- Comportamentais -->
        <div class="crud-block" data-kind="comp">
          <div class="form-grid">
            <!-- ✅ NOVO: lista de competências cadastradas + grupo -->
            <div class="field field--full">
              <label for="c_pick">Selecionar competência cadastrada</label>
              <select id="c_pick">
                <option value="">Selecionar...</option>
              </select>
              <div style="margin-top:6px; font-size:12px; opacity:.7;">
                Ao selecionar, os campos abaixo serão preenchidos automaticamente (você pode ajustar).
              </div>
            </div>

            <div class="field">
              <label for="c_comp">Competência</label>
              <input id="c_comp" type="text" placeholder="Ex: Organização" />
            </div>

            <div class="field">
              <label for="c_grupo">Grupo</label>
              <select id="c_grupo">
                <option>Emocional</option>
                <option>Relacional</option>
                <option>Liderança</option>
                <option>Execução</option>
              </select>
            </div>

            <div class="field">
              <label for="c_grau">Grau</label>
              <input id="c_grau" type="number" min="1" max="5" step="1" value="3" />
            </div>

            <div class="field field--full">
              <label for="c_desc">Descrição</label>
              <textarea id="c_desc" rows="3" placeholder="Descreva a competência..."></textarea>
            </div>

            <div class="field field--full">
              <label for="c_inds">Indicadores (1 por linha)</label>
              <textarea id="c_inds" rows="5" placeholder="Ex:
Mantém documentos organizados.
Segue rotinas sem retrabalho."></textarea>
            </div>
          </div>
        </div>

        <!-- Indicadores de Performance -->
        <div class="crud-block" data-kind="perf">
          <div class="form-grid">
            <div class="field">
              <label for="p_ind">Indicador</label>
              <input id="p_ind" type="text" placeholder="Ex: Cumprimento de prazos" />
            </div>

            <div class="field field--full">
              <label for="p_desc">Descrição</label>
              <textarea id="p_desc" rows="4" placeholder="Descreva o indicador..."></textarea>
            </div>
          </div>
        </div>

        <div class="modal__actions">
          <button class="btn btn--ghost" type="button" data-close="1">Cancelar</button>
          <button class="btn btn--success" type="submit">
            <span class="btn__icon" aria-hidden="true">✓</span>
            Salvar
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // ===== Biblioteca de Competências Comportamentais (conforme documento) =====
    const COMP_LIBRARY = [
      {
        competencia: "Organização",
        descricao: "Capacidade de estruturar e controlar atividades e rotinas.",
        grupo: "Execução",
        grau: "4",
        indicadores: [
          "Mantém documentos físicos e digitais organizados e atualizados.",
          "Segue rotinas administrativas sem gerar retrabalho.",
          "Demonstra facilidade para localizar informações quando solicitado."
        ]
      },
      {
        competencia: "Responsabilidade",
        descricao: "Assumir consequências dos próprios atos e compromissos.",
        grupo: "Execução",
        grau: "5",
        indicadores: [
          "Cumpre prazos e acordos assumidos com autonomia.",
          "Assume suas tarefas sem necessidade de cobranças constantes.",
          "Comunica dificuldades ou imprevistos de forma antecipada."
        ]
      },
      {
        competencia: "Precisão",
        descricao: "Rigor e cuidado na execução das tarefas, com atenção aos detalhes.",
        grupo: "Execução",
        grau: "3",
        indicadores: [
          "Executa tarefas com atenção, reduzindo erros operacionais.",
          "Realiza conferências básicas antes de finalizar entregas.",
          "Demonstra cuidado com dados, informações e registros."
        ]
      },
      {
        competencia: "Foco",
        descricao: "Manter atenção direcionada para objetivos e prioridades.",
        grupo: "Execução",
        grau: "4",
        indicadores: [
          "Mantém atenção nas atividades prioritárias do dia a dia.",
          "Consegue concluir tarefas sem dispersões frequentes.",
          "Organiza seu tempo para finalizar as demandas propostas."
        ]
      },
      {
        competencia: "Trabalho em Equipe",
        descricao: "Capacidade de cooperar com outras pessoas em prol de objetivos comuns.",
        grupo: "Relacional",
        grau: "5",
        indicadores: [
          "Coopera com colegas, oferecendo apoio quando necessário.",
          "Mantém relacionamento respeitoso e colaborativo com o time.",
          "Contribui para o alcance dos objetivos coletivos da área."
        ]
      },
      {
        competencia: "Flexibilidade",
        descricao: "Facilidade de adaptação a mudanças e novos cenários.",
        grupo: "Relacional",
        grau: "3",
        indicadores: [
          "Aceita ajustes nas rotinas e demandas quando necessário.",
          "Demonstra abertura para mudanças de processos e prioridades.",
          "Consegue se adaptar gradualmente a novos contextos de trabalho."
        ]
      },
      {
        competencia: "Comprometimento",
        descricao: "Honrar acordos e dedicar-se com responsabilidade às tarefas.",
        grupo: "Emocional",
        grau: "4",
        indicadores: [
          "Demonstra envolvimento com as atividades sob sua responsabilidade.",
          "Cumpre o que foi combinado com a liderança e a equipe.",
          "Mostra interesse em contribuir para os resultados da área."
        ]
      },
      {
        competencia: "Resiliência",
        descricao: "Capacidade de manter equilíbrio diante de pressão e adversidades.",
        grupo: "Emocional",
        grau: "3",
        indicadores: [
          "Mantém postura equilibrada em momentos de maior demanda.",
          "Consegue lidar com pressões sem comprometer totalmente o desempenho.",
          "Demonstra esforço para manter o controle emocional diante de dificuldades."
        ]
      }
    ];

    // ===== Dados (mock) - conforme documento =====
    const cargoData = {
      "diretor": {
        title: "Diretor(a)",
        cbo: "",
        ultima: "10/01/2026",
        area: "Diretoria",
        depto: "Diretoria",
        ccusto: "N/A",
        lideranca: "Selecione...",
        isLideranca: true,
        status: "Ativo",
        vinculados: "—",
        missao: "—",
        responsabilidades: [],
        tecnicas: [],
        comportamentais: [],
        indicadores: []
      },

      "auxiliar-administrativo": {
        title: "Auxiliar Administrativo",
        cbo: "4110-05 — Auxiliar de escritório",
        ultima: "10/01/2026",
        area: "Administrativo",
        depto: "Administrativo",
        ccusto: "N/A",
        lideranca: "Supervisor Administrativo",
        isLideranca: false,
        status: "Ativo",
        vinculados: "2",
        missao:
          "Apoiar as rotinas administrativas da empresa, assegurando a organização de documentos, o controle adequado das informações e o suporte aos processos internos, contribuindo para a eficiência das atividades e o cumprimento dos prazos estabelecidos.",
        responsabilidades: [
          "Realizar a organização, o arquivamento e a atualização de documentos físicos e digitais da área.",
          "Apoiar o controle e a atualização de planilhas, relatórios e registros administrativos.",
          "Prestar suporte às demandas administrativas internas, atendendo solicitações de diferentes setores.",
          "Efetuar lançamentos e conferências de informações em sistemas internos e controles operacionais.",
          "Auxiliar no acompanhamento de prazos, agendas e atividades administrativas.",
          "Contribuir para a organização do ambiente de trabalho e para a padronização dos processos da área.",
          "Cumprir normas, procedimentos internos e diretrizes estabelecidas pela empresa."
        ],
        tecnicas: [
          { competencia: "Escolaridade", descricao: "Grau de escolaridade exigido para o cargo.", nivel: "Médio" },
          { competencia: "Área de Formação", descricao: "Área de formação compatível com o cargo. Campo pode ser editável conforme necessidade.", nivel: "Administração ou Outras" },
          { competencia: "Experiência na Função", descricao: "Tempo de experiência prática exigido na função.", nivel: "Sem experiência ou até 1 ano" },
          { competencia: "Experiência em Escritório Contábil", descricao: "Vivência anterior em rotinas de escritório contábil.", nivel: "Nenhuma" },
          { competencia: "Excel", descricao: "Nível de domínio de planilhas e recursos do Excel.", nivel: "Básico" },
          { competencia: "Sistemas Contábeis", descricao: "Grau de familiaridade com sistemas contábeis utilizados na rotina.", nivel: "Básico" }
        ],

        // ✅ COMPLETO conforme documento
        comportamentais: [
          ...COMP_LIBRARY.map(x => ({
            competencia: x.competencia,
            descricao: x.descricao,
            grupo: x.grupo,
            grau: x.grau,
            indicadores: [...x.indicadores]
          }))
        ],

        // ✅ COMPLETO conforme documento
        indicadores: [
          { ind: "Organização de documentos", desc: "Mantém arquivos físicos e digitais organizados, facilitando a localização das informações quando solicitadas." },
          { ind: "Cumprimento de prazos", desc: "Entrega as atividades dentro dos prazos combinados, sem necessidade de cobranças constantes." },
          { ind: "Qualidade das entregas", desc: "Executa as tarefas com atenção, reduzindo erros e retrabalho nas rotinas administrativas." },
          { ind: "Responsabilidade com as tarefas", desc: "Assume as demandas recebidas e acompanha até a conclusão, demonstrando comprometimento." },
          { ind: "Apoio às rotinas do setor", desc: "Contribui com as demandas da equipe, oferecendo suporte sempre que solicitado." },
          { ind: "Organização da rotina de trabalho", desc: "Consegue manter uma rotina organizada, priorizando atividades e evitando acúmulo de tarefas." },
          { ind: "Atenção às orientações", desc: "Executa as atividades conforme instruções recebidas, respeitando processos e padrões." },
          { ind: "Postura profissional", desc: "Mantém comportamento adequado, respeito com colegas e cuidado com o ambiente de trabalho." },
          { ind: "Evolução no aprendizado", desc: "Demonstra evolução ao longo do tempo, reduzindo dúvidas e ganhando mais autonomia." },
          { ind: "Compromisso com o trabalho", desc: "Demonstra interesse, envolvimento e disposição para contribuir com o funcionamento da área." }
        ]
      }
    };

    // Completa demais cargos (somente dados gerais do documento)
    const defaultsFromList = {
      "assistente-administrativo": { title:"Assistente Administrativo", area:"Administrativo", depto:"Administrativo", ultima:"10/01/2026", status:"Ativo" },
      "analista-adm-jr": { title:"Analista Administrativo Júnior", area:"Administrativo", depto:"Administrativo", ultima:"10/01/2026", status:"Ativo" },
      "supervisor-administrativo": { title:"Supervisor Administrativo", area:"Administrativo", depto:"Administrativo", ultima:"10/01/2026", status:"Ativo", isLideranca:true },
      "auxiliar-financeiro": { title:"Auxiliar Financeiro", area:"Administrativo", depto:"Financeiro", ultima:"10/01/2026", status:"Ativo" },
      "assistente-financeiro": { title:"Assistente Financeiro", area:"Administrativo", depto:"Financeiro", ultima:"10/01/2026", status:"Ativo" },
      "analista-fin-jr": { title:"Analista Financeiro Júnior", area:"Administrativo", depto:"Financeiro", ultima:"10/01/2026", status:"Ativo" },
      "supervisor-financeiro": { title:"Supervisor Financeiro", area:"Administrativo", depto:"Financeiro", ultima:"10/01/2026", status:"Ativo", isLideranca:true },
      "auxiliar-contabil": { title:"Auxiliar Contábil", area:"Operacional", depto:"Contábil", ultima:"10/01/2026", status:"Ativo" },
      "assistente-contabil": { title:"Assistente Contábil", area:"Operacional", depto:"Contábil", ultima:"10/01/2026", status:"Ativo" },
      "analista-cont-jr": { title:"Analista Contábil Júnior", area:"Operacional", depto:"Contábil", ultima:"10/01/2026", status:"Ativo" },
      "supervisor-contabil": { title:"Supervisor Contábil", area:"Operacional", depto:"Contábil", ultima:"10/01/2026", status:"Ativo", isLideranca:true },
      "coordenador-contabil": { title:"Coordenador Contábil", area:"Operacional", depto:"Contábil", ultima:"10/01/2026", status:"Ativo", isLideranca:true },
      "auxiliar-fiscal": { title:"Auxiliar Fiscal", area:"Operacional", depto:"Fiscal", ultima:"10/01/2026", status:"Ativo" },
      "assistente-fiscal": { title:"Assistente Fiscal", area:"Operacional", depto:"Fiscal", ultima:"10/01/2026", status:"Ativo" },
      "analista-fisc-jr": { title:"Analista Fiscal Júnior", area:"Operacional", depto:"Fiscal", ultima:"10/01/2026", status:"Ativo" },
      "supervisor-fiscal": { title:"Supervisor Fiscal", area:"Operacional", depto:"Fiscal", ultima:"10/01/2026", status:"Ativo", isLideranca:true },
      "coordenador-fiscal": { title:"Coordenador Fiscal", area:"Operacional", depto:"Fiscal", ultima:"10/01/2026", status:"Ativo", isLideranca:true },
      "auxiliar-dp": { title:"Auxiliar de DP", area:"Operacional", depto:"Departamento Pessoal", ultima:"10/01/2026", status:"Ativo" },
      "assistente-dp": { title:"Assistente de DP", area:"Operacional", depto:"Departamento Pessoal", ultima:"10/01/2026", status:"Ativo" },
      "analista-dp-jr": { title:"Analista de DP Júnior", area:"Operacional", depto:"Departamento Pessoal", ultima:"10/01/2026", status:"Ativo" },
      "supervisor-dp": { title:"Supervisor de DP", area:"Operacional", depto:"Departamento Pessoal", ultima:"10/01/2026", status:"Ativo", isLideranca:true },
      "consultor-comercial-i": { title:"Consultor Comercial I", area:"Comercial", depto:"Vendas", ultima:"10/01/2026", status:"Ativo" },
      "consultor-comercial-ii": { title:"Consultor Comercial II", area:"Comercial", depto:"Vendas", ultima:"10/01/2026", status:"Ativo" },
      "consultor-comercial-iii": { title:"Consultor Comercial III", area:"Comercial", depto:"Vendas", ultima:"10/01/2026", status:"Ativo" },
      "supervisor-comercial": { title:"Supervisor Comercial", area:"Comercial", depto:"Vendas", ultima:"10/01/2026", status:"Ativo", isLideranca:true }
    };

    Object.entries(defaultsFromList).forEach(([k, v]) => {
      if (!cargoData[k]) cargoData[k] = {
        title: v.title,
        cbo: "",
        ultima: v.ultima,
        area: v.area,
        depto: v.depto,
        ccusto: "N/A",
        lideranca: "Selecione...",
        isLideranca: !!v.isLideranca,
        status: v.status,
        vinculados: "—",
        missao: "—",
        responsabilidades: [],
        tecnicas: [],
        comportamentais: [],
        indicadores: []
      };
    });

    // ===== Helpers UI =====
    const $ = (s) => document.querySelector(s);
    const $$ = (s) => document.querySelectorAll(s);

    const viewList = $("#view-list");
    const viewDetail = $("#view-detail");

    const cargoTitle = $("#cargoTitle");
    const f_nome = $("#f_nome");
    const f_cbo = $("#f_cbo");
    const f_ultima = $("#f_ultima");
    const f_area = $("#f_area");
    const f_depto = $("#f_depto");
    const f_ccusto = $("#f_ccusto");
    const f_lideranca = $("#f_lideranca");
    const f_vinc = $("#f_vinculados");
    const missaoText = $("#missaoText");
    const respList = $("#respList");
    const tecTbody = $("#tecTbody");
    const compTbody = $("#compTbody");
    const perfTbody = $("#perfTbody");

    const leadSim = $("#leadSim");
    const leadNao = $("#leadNao");

    const btnNewCargo = $("#btnNewCargo");
    const btnSalvarCargo = $("#btnSalvarCargo");
    const btnEditarCargo = $("#btnEditarCargo");

    let currentCargoId = null;
    let currentMode = "view"; // view | create

    function setActiveView(detailOn) {
      viewList.classList.toggle("is-active", !detailOn);
      viewDetail.classList.toggle("is-active", detailOn);
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function clearChildren(el) {
      while (el.firstChild) el.removeChild(el.firstChild);
    }

    function setStatusRadio(status){
      const radios = $$('input[name="status"]');
      radios.forEach(r => r.checked = (r.value === status));
      if (![...radios].some(r => r.checked)) radios[0].checked = true;
    }

    function setLeaderToggle(isLeader){
      leadSim.classList.toggle("is-active", !!isLeader);
      leadNao.classList.toggle("is-active", !isLeader);
    }

    leadSim.addEventListener("click", () => setLeaderToggle(true));
    leadNao.addEventListener("click", () => setLeaderToggle(false));

    function escapeHtml(str){
      return String(str || "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function todayBR(){
      const d = new Date();
      const dd = String(d.getDate()).padStart(2, "0");
      const mm = String(d.getMonth()+1).padStart(2, "0");
      const yy = d.getFullYear();
      return `${dd}/${mm}/${yy}`;
    }

    // ===== Render tables =====
    function renderTecnicas(data){
      clearChildren(tecTbody);
      (data.tecnicas || []).forEach((row, idx) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td class="strong">${escapeHtml(row.competencia)}</td>
          <td>${escapeHtml(row.descricao)}</td>
          <td class="col-small">${escapeHtml(row.nivel)}</td>
          <td class="col-actions">
            <button class="btn btn--ghost btn--sm" type="button" data-action="edit-tec" data-index="${idx}">Editar</button>
          </td>
        `;
        tecTbody.appendChild(tr);
      });
    }

    function renderComportamentais(data){
      clearChildren(compTbody);
      (data.comportamentais || []).forEach((row, idx) => {
        const indicators = (row.indicadores || [])
          .map(i => `<li>${escapeHtml(i)}</li>`).join("");

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td class="strong">${escapeHtml(row.competencia)}</td>
          <td>${escapeHtml(row.descricao)}</td>
          <td class="col-small">${escapeHtml(row.grupo)}</td>
          <td class="col-mini">${escapeHtml(row.grau)}</td>
          <td><ul class="mini-list">${indicators || ""}</ul></td>
          <td class="col-actions">
            <button class="btn btn--ghost btn--sm" type="button" data-action="edit-comp" data-index="${idx}">Editar</button>
          </td>
        `;
        compTbody.appendChild(tr);
      });
    }

    function renderPerf(data){
      clearChildren(perfTbody);
      (data.indicadores || []).forEach((row, idx) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td class="strong">${escapeHtml(row.ind)}</td>
          <td>${escapeHtml(row.desc)}</td>
          <td class="col-actions">
            <button class="btn btn--ghost btn--sm" type="button" data-action="edit-perf" data-index="${idx}">Editar</button>
          </td>
        `;
        perfTbody.appendChild(tr);
      });
    }

    function openCargo(id, mode="view") {
      const data = cargoData[id] || cargoData["auxiliar-administrativo"];
      currentCargoId = id;
      currentMode = mode;

      cargoTitle.textContent = (mode === "create") ? "Novo Cargo" : data.title;

      f_nome.value = (mode === "create") ? "" : (data.title || "");
      f_cbo.value = (mode === "create") ? "" : (data.cbo || "");
      f_ultima.textContent = (mode === "create") ? todayBR() : (data.ultima || "—");
      f_area.value = data.area || "Administrativo";
      f_depto.value = data.depto || "Administrativo";
      f_ccusto.value = data.ccusto || "N/A";
      f_lideranca.value = data.lideranca || "Selecione...";
      f_vinc.textContent = (mode === "create") ? "—" : (data.vinculados || "—");

      setLeaderToggle(!!data.isLideranca);
      setStatusRadio(data.status || "Ativo");

      missaoText.textContent = data.missao || "—";

      clearChildren(respList);
      (data.responsabilidades || []).forEach((item) => {
        const li = document.createElement("li");
        li.innerHTML = `
          <span class="check" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M9 16.2 4.8 12 3.4 13.4 9 19l12-12-1.4-1.4z"/></svg>
          </span>
          <span>${escapeHtml(item)}</span>
        `;
        respList.appendChild(li);
      });

      renderTecnicas(data);
      renderComportamentais(data);
      renderPerf(data);

      // botões de ação do cargo
      btnSalvarCargo.hidden = (mode !== "create");
      btnEditarCargo.hidden = (mode === "create");

      activateTab("dados");
      setActiveView(true);
      history.replaceState(null, "", "#" + id);
    }

    // Clique no nome do cargo
    $$(".row-link").forEach(btn =>
      btn.addEventListener("click", () => openCargo(btn.dataset.id, "view"))
    );

    // ✅ incluir cargo abre a tela
    btnNewCargo.addEventListener("click", () => {
      // id temporário (não cria na lista ainda)
      openCargo("__novo__", "create");
    });

    // ✅ salvar novo cargo (protótipo)
    btnSalvarCargo.addEventListener("click", () => {
      const title = (f_nome.value || "").trim();
      if (!title) return alert("Informe o nome do cargo.");

      const id = title
        .toLowerCase()
        .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
        .replace(/[^a-z0-9]+/g, "-")
        .replace(/(^-|-$)/g, "");

      if (cargoData[id]) {
        return alert("Já existe um cargo com esse nome. Troque o nome.");
      }

      const status = [...$$('input[name="status"]')].find(r => r.checked)?.value || "Ativo";

      cargoData[id] = {
        title,
        cbo: (f_cbo.value || "").trim(),
        ultima: todayBR(),
        area: f_area.value,
        depto: f_depto.value,
        ccusto: f_ccusto.value,
        lideranca: f_lideranca.value,
        isLideranca: leadSim.classList.contains("is-active"),
        status,
        vinculados: "—",
        missao: "—",
        responsabilidades: [],
        tecnicas: [],
        comportamentais: [],
        indicadores: []
      };

      // adiciona linha na tabela
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><button class="row-link" type="button" data-id="${escapeHtml(id)}">${escapeHtml(title)}</button></td>
        <td>${escapeHtml(f_area.value)}</td>
        <td>${escapeHtml(f_depto.value)}</td>
        <td class="col-date">${escapeHtml(todayBR())}</td>
        <td class="col-status"><span class="badge ${status === "Ativo" ? "badge--active" : "badge--inactive"}">${escapeHtml(status)}</span></td>
      `;
      $("#cargosTbody").prepend(tr);

      tr.querySelector(".row-link").addEventListener("click", () => openCargo(id, "view"));

      alert("Salvo (protótipo) — ainda não grava em banco.");
      openCargo(id, "view");
    });

    // Voltar
    $("#btnBack").addEventListener("click", () => setActiveView(false));

    // Busca simples
    $("#searchInput").addEventListener("input", (e) => {
      const q = (e.target.value || "").toLowerCase();
      $$("#cargosTbody tr").forEach(tr => {
        const text = tr.innerText.toLowerCase();
        tr.style.display = text.includes(q) ? "" : "none";
      });
    });

    // Tabs (somente do detalhe)
    const tabs = $$("#view-detail .tabs__tab");
    const panels = {
      dados: $("#tab-dados"),
      responsabilidades: $("#tab-responsabilidades"),
      tecnicas: $("#tab-tecnicas"),
      comportamentais: $("#tab-comportamentais"),
      indicadores: $("#tab-indicadores"),
    };

    function activateTab(key) {
      tabs.forEach(t => t.classList.toggle("is-active", t.dataset.tab === key));
      Object.entries(panels).forEach(([k, el]) => el.classList.toggle("is-active", k === key));
    }
    tabs.forEach(btn => btn.addEventListener("click", () => activateTab(btn.dataset.tab)));

    // ===== Modal CRUD =====
    const crudModal = $("#crudModal");
    const crudTitle = $("#crudTitle");
    const crudForm = $("#crudForm");
    const crudKind = $("#crudKind");
    const crudMode = $("#crudMode");
    const crudIndex = $("#crudIndex");

    const blocks = $$("#crudModal .crud-block");

    // ✅ seletor de competência cadastrada (Comportamentais)
    const c_pick = $("#c_pick");

    function showBlock(kind){
      blocks.forEach(b => b.hidden = (b.dataset.kind !== kind));
    }

    function populateCompPick(){
      if (!c_pick) return;
      c_pick.innerHTML = `<option value="">Selecionar...</option>` + COMP_LIBRARY
        .map(c => `<option value="${escapeHtml(c.competencia)}">${escapeHtml(c.competencia)} — ${escapeHtml(c.grupo)}</option>`)
        .join("");
    }

    function fillCompFromLibrary(name){
      const item = COMP_LIBRARY.find(x => x.competencia === name);
      if (!item) return;

      $("#c_comp").value = item.competencia || "";
      $("#c_desc").value = item.descricao || "";
      $("#c_grupo").value = item.grupo || "Execução";
      $("#c_grau").value = item.grau || "3";
      $("#c_inds").value = (item.indicadores || []).join("\n");
    }

    if (c_pick){
      c_pick.addEventListener("change", () => {
        const name = (c_pick.value || "").trim();
        if (!name) return;
        fillCompFromLibrary(name);
      });
    }

    function openCrud(kind, mode="create", index=-1){
      if (!currentCargoId || !cargoData[currentCargoId]) {
        // se for modo create do cargo, cria container temporário
        if (currentMode === "create") {
          cargoData[currentCargoId] = cargoData[currentCargoId] || {
            title: "Novo",
            cbo: "",
            ultima: todayBR(),
            area: f_area.value || "Administrativo",
            depto: f_depto.value || "Administrativo",
            ccusto: "N/A",
            lideranca: "Selecione...",
            isLideranca: false,
            status: "Ativo",
            vinculados: "—",
            missao: "—",
            responsabilidades: [],
            tecnicas: [],
            comportamentais: [],
            indicadores: []
          };
        }
      }

      crudKind.value = kind;
      crudMode.value = mode;
      crudIndex.value = String(index);

      showBlock(kind);
      crudForm.reset();

      // set defaults
      if (kind === "comp") $("#c_grau").value = "3";

      // ✅ prepara lista de competências cadastradas
      if (kind === "comp") {
        populateCompPick();
        c_pick.value = "";
      }

      const data = cargoData[currentCargoId];
      if (mode === "edit" && index >= 0) {
        if (kind === "tec") {
          const r = data.tecnicas[index];
          $("#t_comp").value = r?.competencia || "";
          $("#t_desc").value = r?.descricao || "";
          $("#t_nivel").value = r?.nivel || "";
        }
        if (kind === "comp") {
          const r = data.comportamentais[index];
          $("#c_comp").value = r?.competencia || "";
          $("#c_desc").value = r?.descricao || "";
          $("#c_grupo").value = r?.grupo || "Execução";
          $("#c_grau").value = r?.grau || "3";
          $("#c_inds").value = (r?.indicadores || []).join("\n");

          // tenta selecionar no "cadastradas" se existir
          if (c_pick) {
            const exists = COMP_LIBRARY.some(x => x.competencia === (r?.competencia || ""));
            c_pick.value = exists ? (r?.competencia || "") : "";
          }
        }
        if (kind === "perf") {
          const r = data.indicadores[index];
          $("#p_ind").value = r?.ind || "";
          $("#p_desc").value = r?.desc || "";
        }
      }

      crudTitle.textContent =
        (kind === "tec" ? (mode === "edit" ? "Editar Competência Técnica" : "Incluir Competência Técnica") :
        kind === "comp" ? (mode === "edit" ? "Editar Competência Comportamental" : "Incluir Competência Comportamental") :
        (mode === "edit" ? "Editar Indicador de Performance" : "Incluir Indicador de Performance"));

      crudModal.hidden = false;
      document.body.classList.add("modal-open");
    }

    function closeCrud(){
      crudModal.hidden = true;
      document.body.classList.remove("modal-open");
    }

    // botões incluir
    $("#btnAddTec").addEventListener("click", () => openCrud("tec", "create", -1));
    $("#btnAddComp").addEventListener("click", () => openCrud("comp", "create", -1));
    $("#btnAddPerf").addEventListener("click", () => openCrud("perf", "create", -1));

    // editar por linha
    document.addEventListener("click", (e) => {
      const btn = e.target.closest("[data-action]");
      if (!btn) return;

      const idx = Number(btn.dataset.index || "-1");
      if (btn.dataset.action === "edit-tec") openCrud("tec", "edit", idx);
      if (btn.dataset.action === "edit-comp") openCrud("comp", "edit", idx);
      if (btn.dataset.action === "edit-perf") openCrud("perf", "edit", idx);
    });

    // fechar modal
    crudModal.addEventListener("click", (e) => {
      if (e.target && e.target.getAttribute("data-close")) closeCrud();
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && !crudModal.hidden) closeCrud();
    });

    // salvar modal
    crudForm.addEventListener("submit", (e) => {
      e.preventDefault();

      const kind = crudKind.value;
      const mode = crudMode.value;
      const index = Number(crudIndex.value || "-1");
      const data = cargoData[currentCargoId];

      if (!data) return alert("Selecione um cargo primeiro.");

      if (kind === "tec") {
        const row = {
          competencia: ($("#t_comp").value || "").trim(),
          descricao: ($("#t_desc").value || "").trim(),
          nivel: ($("#t_nivel").value || "").trim()
        };
        if (!row.competencia) return alert("Informe a competência.");

        if (mode === "edit" && index >= 0) data.tecnicas[index] = row;
        else data.tecnicas.unshift(row);

        renderTecnicas(data);
      }

      if (kind === "comp") {
        const inds = ($("#c_inds").value || "")
          .split("\n").map(s => s.trim()).filter(Boolean);

        const row = {
          competencia: ($("#c_comp").value || "").trim(),
          descricao: ($("#c_desc").value || "").trim(),
          grupo: ($("#c_grupo").value || "").trim(),
          grau: String(($("#c_grau").value || "3")).trim(),
          indicadores: inds
        };
        if (!row.competencia) return alert("Informe a competência.");

        if (mode === "edit" && index >= 0) data.comportamentais[index] = row;
        else data.comportamentais.unshift(row);

        renderComportamentais(data);
      }

      if (kind === "perf") {
        const row = {
          ind: ($("#p_ind").value || "").trim(),
          desc: ($("#p_desc").value || "").trim()
        };
        if (!row.ind) return alert("Informe o indicador.");

        if (mode === "edit" && index >= 0) data.indicadores[index] = row;
        else data.indicadores.unshift(row);

        renderPerf(data);
      }

      alert("Salvo (protótipo) — ainda não grava em banco.");
      closeCrud();
    });

    // Abrir um exemplo por URL: cargos.html#auxiliar-administrativo
    const hash = (location.hash || "").replace("#", "").trim();
    if (hash && cargoData[hash]) openCargo(hash, "view");
  </script>
</body>
</html>
